/* filename: vlt_HeatCap.c *//* description: This C program calculates the molar specific heat capacity c_V of a system of liquid helium-4 at different temperatures and length scales.       The filename vlt_HeatCap.c refers to the "vortex loop theory" (vlt) of the superfluid phase transition and the molar specific "heat capacity" (HeatCap) of the system under examination. *//* ext files: derk1.c *//* author: Andrew Forrester <aforrester@ucla.edu> */// NOTE: Be sure that N=3 in derk1.c when compiling./*  Function preparation  *//*=========================================================================*/#include <stdio.h>#include <math.h>#define IN#define OUT#define INOUT#define PI     3.14159265#define PISQ   9.8696044#define A      4.0*PI*PI*PI/3.0#define D     -1.0#define a0     2.56#define K0c    0.3091469984216758#define Cc     1.03#define DK0    1e-7#define N      3typedef struct {	double l;	double tempv;	double thrmv[N];} STATE;typedef struct {	double arr[N];} RETARRAY;/*  Function prototypes  *//*=========================================================================*///   derk(func(),calculated,Dl,n)//   ringrecrel(l,z)extern STATE derk(RETARRAY (*func)(double l, double z[]), STATE calculated, double Dl, unsigned n);RETARRAY ringrecrel(double l, double z[]);/*  Function definitions  *//*=========================================================================*/main(){	int i,j=0;	double a,Kr,K0,cap,derivplus,derivminus;	//double T,rho,rhos,x,Delok,Cc,K0,Kr,a;	STATE estimated, plus, minus;	FILE *outfile;	/* Print headings for data to screen and output file */	outfile = fopen("vlt_HeatCap_DK0_1e-0.dat","w");  //  "vlt_HeatCap.out"	fprintf(outfile,"%s\t%s\t%s\t%s\t%s\t\n", "tempv","cap*8.31","l","Kr/K0","F");	printf(         "%s\t%s\t%s\t%s\t%s\t\n", "tempv","cap*8.31","l","Kr/K0","F");	/* Loop through different temperatures (calculations for each temp are independent)? */	for(i=0; i<35; i++){		/* Decrement temperature (further below Tc) */		estimated.tempv = (1.0e-8)*exp(0.4*i);		/* Initialize lengthscale and energy values, zero in/decrements */		estimated.l = 0.0;		plus.l      = 0.0;		minus.l     = 0.0;		a = a0*exp(estimated.l);		estimated.thrmv[2] = 0.0;		plus.thrmv[2]      = 0.0;		minus.thrmv[2]     = 0.0;		/* Initialize temperature-dependent values at initial lengthscale */		K0 = K0c/(1.0-estimated.tempv);		estimated.thrmv[0] = K0;		plus.thrmv[0]      = K0+DK0;		minus.thrmv[0]     = K0-DK0;		estimated.thrmv[1] = exp(-PISQ*K0*Cc);		plus.thrmv[1]      = exp(-(K0+DK0)*PISQ*Cc);		minus.thrmv[1]     = exp(-(K0-DK0)*PISQ*Cc);		Kr = K0;		while(a>0.0){			estimated = derk(IN ringrecrel, INOUT estimated, IN 0.0001, IN N);			plus      = derk(IN ringrecrel, INOUT plus,      IN 0.0001, IN N);			minus     = derk(IN ringrecrel, INOUT minus,     IN 0.0001, IN N);			a = a0*exp(estimated.l);			Kr = estimated.thrmv[0]*a0/a;			j = j+1;			derivplus = (plus.thrmv[2]-estimated.thrmv[2])/DK0;			derivminus = (estimated.thrmv[2]-minus.thrmv[2])/DK0;			cap = D*K0*K0*(derivplus-derivminus)/DK0;			/*if(j%2000==0)				printf("%G %g %g %g \n%1.18e\n",t,Kr/K0,y[0],y[1],cap);			if(j>10000)				j=0;*/			if(estimated.thrmv[0]>6)				break;		}		cap = D*K0*K0*(derivplus-derivminus)/DK0;		fprintf(outfile,"%g\t%g\t%g\t%g\t%g\n",			estimated.tempv, cap*8.31, estimated.l, Kr/K0, estimated.thrmv[2]);		fflush(outfile);		printf(         "%g\t%g\t%g\t%g\t%g\n",			estimated.tempv, cap*8.31, estimated.l, Kr/K0, estimated.thrmv[2]);	}	fclose(outfile);}// vortex "ring" recursion relationsRETARRAY ringrecrel(double l, double z[]){	RETARRAY dzdl;	dzdl.arr[0] = z[0]-A*z[1]*z[0]*z[0];	dzdl.arr[1] = z[1]*(6.0-PISQ*z[0]*(1.0-0.6*log(z[0])));	dzdl.arr[2] = -PI*z[1]*exp(-3.0*l);	return dzdl;}