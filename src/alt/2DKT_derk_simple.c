/*  File Comments  *//*=========================================================================*//* FILENAME: vlt_derk.c *//* AUTHOR: Andrew Forrester <aforrester@ucla.edu>  *//* DESCRIPTION:   This C program employs the 4th-order Runge Kutta method in conjunction with the other vlt (vortex loop theory) programs (vlt_ThermStates.c, etc.) to solve for thermodynamic quantities as functions of temperature, length scale, and sometimes pressure.   In the filename, "vlt" stands for Vortex Loop Theory (of the superfluid phase transition) and "derk" stands for the Differential Equation Runge Kutta method.   See below the code for explanation of constants and variables.   Input:   Output:*//* REF FILE: vlt_ThermStates.c, vlt_K0cFind.c, vlt_HeatCap.c, ring1.c, 2DTK.c, etc. *//*  Function Preparation  *//*=========================================================================*//* Standard routine header files */#include <stdio.h>/* Constants and labels */#define IN    // input label#define OUT   // output label#define INOUT // input/output label/* Program parameters/inputs */#define N     2  // If using ring1.c N=3, If using 2DKT.c or K0cFind1.c N=2/* Data type definitions */typedef struct {	double c[N];} RETARRAY;/*  Function definition  *//*=========================================================================*///   derk(func(),calcKy,calcl,Dl,n)//   func(l,z)RETARRAY derk(RETARRAY (*func)(double l, double z[]), RETARRAY calcKy, double calcl, double Dl, unsigned n){	int i,j;	double dl,testl[3];	RETARRAY DKyDl[4], testKy[3];	/* Calculate the derivatives at the input calculated state and 3n test states */	DKyDl[0] = func(IN calcl, IN calcKy.c);	for(i=0; i<3; i++){		dl = Dl*((i+2)/2)/2;  // See "Note" below.		for(j=0; j<n; j++){			testKy[i].c[j] = calcKy.c[j] + DKyDl[i].c[j]*dl;		}		testl[i] = calcl + Dl*((i+1)/2)/2;  // See "Note" below.		DKyDl[i+1] = func(IN testl[i], IN testKy[i].c);	}	// Note: This algorithm, using '((...)/2)/2', creates a desired rounding "error" that produces the sequence 0.0, 0.5, 0.5, 1.0, instead of 0.0, 0.5, 0.75, 1.0.	/* Update the calculated state, using the derivatives calculated above */	for(j=0; j<n; j++) calcKy.c[j] += Dl*(DKyDl[0].c[j]+2*(DKyDl[1].c[j]+DKyDl[2].c[j])+DKyDl[3].c[j])/6;	//calcl += Dl;	/* Return the new calculated state */	return calcKy;}/*  Program Notes  *//*=========================================================================*//*See further documentation (UCLAresearchNotes.pdf, UCLAresearchPrograms.pdf, vlt_ThermStates.c, ring1.c) for elaboration.Dl is the increment in l.n is the number of thermodynamic variables (n=3 given thermv[i], i=1,2,3).DthrmvDl[i].arr[0] = dK/dlDthrmvDl[i].arr[1] = dy/dlDthrmvDl[i].arr[2] = de/dl*/