/* filename: derk2.c *//* description: This program employs the 4th-order Runge Kutta method in conjunction with ring1.c to solve for thermodynamic quantities as functions of temperature and length scale.       The filename "derk" (D.E.R.K.) apparently stands for the Differential Equation Runge Kutta method.       See below the code for explanation of constants and variables. *//* ref file: ring2.c *//* author: Andrew Forrester <aforrester@ucla.edu>  */// In derk.c, given that `s = (double *)calloc(n,sizeof(double))', why is `free((char *)s)' used instead of `free((double *)s)' ?#include <stdlib.h>#define IN#define OUT#define INOUT/*  Function definition  *//*=========================================================================*///   derk(func(),calculated,lPtr,Dl,n)//   func(l,z,dzdl)void derk(void (*func)(double l, double z[], double dzdl[]), double calculated[], double *lPtr, double Dl, unsigned n){	double *DthrmvDl[4], *test, testl, dl;	int i,j;	/* Create DthrmvDl[4][n] and test[n] in a manner that prevents memory leakage (using 'free', below) */	for(i=0; i<4; i++)  DthrmvDl[i] = (double *)calloc(n,sizeof(double));	test = (double *)calloc(n,sizeof(double));	/* Calculate the derivatives at the input calculated state and 3n test states */	func(IN *lPtr, IN calculated, OUT DthrmvDl[0]);	for(i=0; i<3; i++){		dl = Dl*((i+2)/2)/2;  // See "Note" below.		for(j=0; j<n; j++){			test[j] = calculated[j] + DthrmvDl[i][j]*dl;			testl = *lPtr + Dl*((i+1)/2)/2;  // See "Note" below.		}		func(IN testl, IN test, OUT DthrmvDl[i+1]);	}	// Note: This algorithm, using '((...)/2)/2', creates a desired rounding "error" that produces the sequence 0.0, 0.5, 0.5, 1.0, instead of 0.0, 0.5, 0.75, 1.0.	/* Update the calculated state, using the derivatives calculated above */	for(j=0; j<n; j++)  calculated[j] += Dl*(DthrmvDl[0][j]+2*(DthrmvDl[1][j]+DthrmvDl[2][j])+DthrmvDl[3][j])/6;	*lPtr += Dl;	/* "Free up" and keep the same memory locations of these arrays using 'free', to prevent memory leakage */	for(i=0; i<4; i++)  free((double *) DthrmvDl[i]);	free((double *)test);}